<div class="-u-page submission">
  <!-- <div><a href="/submissions" class="-u-link-default">&larr;</a></div> -->
  <% const {id, type, status, title, comment, subscription, releaseDate,
    approvedDate, createdAt, user, labelArtist, linkId, link, tracks, artworkUpload} = pageData;%>
  <div class="single-head">
    <a class="single-head__back" href="/fmadmincp/submissions">
      <span
        class="iconify"
        data-icon="ion:arrow-back-circle-outline"
        data-inline="false"
      ></span>
      <span>Back</span>
    </a>
    <div class="single-head__title -u-id-head">
      <span>Submission</span>
      <span>&mdash;</span>
      <span><%= id %></span>
    </div>
  </div>
  <div class="submission__alert">
    <% if(comment) { %>
    <div class="submission__alert__comment">
      <% if(Fns.isAdminPage) { %>
      <div
        class="submission__alert__comment--pen"
        data-id="<%= id %>"
        id="decline-comment-edit"
      >
        <span
          class="iconify"
          data-icon="dashicons:edit-large"
          data-inline="false"
        ></span>
      </div>
      <% } %>
      <div
        class="submission__alert__comment--text alert alert-danger text-center"
        id="decline-comment"
      >
        <%= comment %>
      </div>
    </div>
    <% } %>
  </div>
  <section class="submission__body">
    <section class="submission__details">
      <div class="submission__details__overview flex-column flex-md-row">
        <div
          class="submission__details__overview__image mb-4 mr-0 mr-md-5 mb-md-5"
        >
          <div class="submission__details__overview__image__box">
            <img
              class="submission__details__overview__image__box--img"
              src="<%= artworkUpload.secureUrl || '/dist/no-image.jpg' %>"
              alt="<%= title %> artwork"
            />
          </div>
        </div>
        <div class="submission__details__overview__info">
          <div class="-u-font-big submission__details__overview__info--title">
            <%= title %>
          </div>
          <div class="submission__details__overview__info__list">
            <ul class="submission__list">
              <li class="submission__list__item">
                <div class="submission__list__item--title">
                  <%=type === 'track' ? 'single' : 'album' %> by
                </div>
                <div class="submission__list__item--details">
                  <%= Fns.capitalize(labelArtist ? labelArtist.stageName :
                  user.profile.stageName) %>
                </div>
              </li>
              <li class="submission__list__item">
                <div class="submission__list__item--title">language</div>
                <div class="submission__list__item--details">-</div>
              </li>
              <li class="submission__list__item">
                <div class="submission__list__item--title">label</div>
                <div class="submission__list__item--details">
                  <%=Fns.capitalize(user.profile.label) %>
                </div>
              </li>
              <li class="submission__list__item">
                <div class="submission__list__item--title">UPC/EAN</div>
                <div class="submission__list__item--details">-</div>
              </li>
              <li class="submission__list__item">
                <div class="submission__list__item--title">Sub. package</div>
                <div class="submission__list__item--details">
                  <%= Fns.capitalize(subscription.package.package) %>
                </div>
              </li>
              <li class="submission__list__item">
                <div class="submission__list__item--title">Sub. status</div>
                <div class="submission__list__item--details">
                  <span
                    class="badge badge-pill badge-<%=Fns.colorText(subscription.status) %>"
                    ><%= subscription.status %></span
                  >
                </div>
              </li>
              <li class="submission__list__item">
                <div class="submission__list__item--title">SUBSCRIBER</div>
                <div class="submission__list__item--details"><%= user.profile.stageName %></div>
              </li>
              <li class="submission__list__item">
                <div class="submission__list__item--title">profile</div>
                <div class="submission__list__item--details">
                  <a href="/fmadmincp/subscriber?id=<%= user.id %>">view</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="submission__details__options p-5">
        <div>
          <div
            class="-u-font-big submission__details__overview__info--title mb-2"
          >
            Status
          </div>
          <div>
            <span class="badge badge-pill badge-<%=Fns.colorText(status) %>"
              ><%= status %></span
            >
            <span><a class="ml-3" href="/fmadmincp/subscription?id=<%= subscription.id %>">view</a></span>
          </div>                                 
        </div>
        <div>
          <div
            class="-u-font-big submission__details__overview__info--title mb-4"
          >
            Dates
          </div>
          <ul class="submission__list">
            <li class="submission__list__item">
              <div class="submission__list__item--title">added</div>
              <div class="submission__list__item--details">
                <%= Fns.dateFormat(createdAt) %>
              </div>
            </li>
            <li class="submission__list__item">
              <div class="submission__list__item--title">approved</div>
              <div class="submission__list__item--details">
                <%= Fns.dateFormat(approvedDate) || '-' %>
              </div>
            </li>
            <li class="submission__list__item">
              <div class="submission__list__item--title">release</div>
              <div class="submission__list__item--details">
                <%= Fns.dateFormat(releaseDate) %>
              </div>
            </li>
            <li class="submission__list__item">
              <div class="submission__list__item--title">original release</div>
              <div class="submission__list__item--details">-</div>
            </li>
          </ul>
        </div>
      </div>
      <section class="mt-5 border-0">
        <div class="-u-font-bold mb-4"><%= type === 'track' ? 'TRACK' : 'TRACKS-LIST' %></div>
        <table
          data-toggle="table"
          data-classes="table table-hovered table-striped"
          data-mobile-responsive="true"
          data-mobile="true"
        >
          <thead>
            <tr>
              <th>Title</th>
              <th>Artiste</th>
              <th>Featured</th>
              <th>Genre</th>
              <th>Explicit</th>
              <th>Copyright</th>
              <th>Year</th>
              <th>Upload</td>
            </tr>
          </thead>
          <tbody>
            <% tracks.forEach(({title, artiste, featured, genre, explicit,
            copyrightYear, copyrightHolder, trackUpload: {secureUrl}}) => { %>
            <tr>
              <td><%= title %></td>
              <td><%= artiste %></td>
              <td><%= featured %></td>
              <td><%= genre %></td>
              <td><%= explicit %></td>
              <td><%= copyrightHolder %></td>
              <td><%= copyrightYear %></td>
              <td><%- secureUrl && `<a href='${secureUrl}'>view</a>` %></td>
            </tr>
            <% }) %>
          </tbody>
        </table>
      </section>
    </section>
  </section>
  <hr />
  <% if(subscription.status === 'inactive' || status === 'deleted' || status ===
  'incomplete') { %>

  <div class="alert alert-info text-center -u-mw-450">
    You cannot approve or decline this <b><%= type %></b> release, as a result
    of either inactive subscription or it has been marked as deleted or an
    incomplete submission
  </div>

  <% } else { %>
  <div class="admin-submission">
    <div class="row admin-submission__action__btns text-center">
      <% if(['incomplete', 'processing', 'declined'].includes(status)) { %>
      <div class="col-xs-12 col-md">
        <button
          class="btn btn-success"
          data-url="/fmadmincp/submission/action/approve?id=<%=id %>"
        >
          Approve
        </button>
      </div>
   <% } %>
   <% if(['incomplete', 'processing'].includes(status)) { %>
      <div class="col-xs-12 col-md">
        <button
          id="decline"
          class="btn btn-danger"
          data-url="/fmadmincp/submission/action/decline?id=<%=id %>"
        >
          Decline
        </button>
      </div>
      <% } %>
      <% if(!(['incomplete', 'processing', 'declined'].includes(status))) { %>
      <div class="col-xs-12 col-md">
        <% if(status === 'in stores') { %>
        <button
          id="store-link"
          class="btn-outline"
          data-type="edit"
          data-link_id="<%=Fns.idLookUp(linkId) %>"
        >
          Edit Links
        </button>
        <% } else { %>
        <button
          id="store-link"
          class="btn btn-primary"
          data-type="add"
          data-submission_id="<%=id %>"
          data-details="<%=JSON.stringify({stageName: user.type === 'label' ? labelArtist.stageName : user.profile.stageName, title}) %>"
        >
          Add Links
        </button>
        <% } %>
      </div>
      <% } %>
    </div>
  </div>
  <% } %>
  <div class="mt-3 text-center">
    <% if(['incomplete', 'processing', 'declined'].includes(status)) { %>
    <button
      class="btn btn-danger"
      data-url="/fmadmincp/submission/action/delete?id=<%=id %>"
    >
      Delete
    </button>
    <% } %>
  </div>
</div>
